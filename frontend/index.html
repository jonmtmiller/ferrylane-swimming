<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><text y='50%' x='50%' dominant-baseline='middle' text-anchor='middle' font-size='48'>üèä</text></svg>">
  <title>Ferry Lane Swimming</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
</head>
<body>
  <header class="page-header">
    <h1 class="logo">Ferry Lane Swimming <span aria-label="Club (crossed out)" role="text"><s>Club</s></span></h1>
    <p class="tagline">Current river conditions for Wargrave (unofficial)</p>
    <p class="tagline">Come to <a href="https://www.purpleturtlebar.com/#calendar-1b55a3f5-2b2e-4448-be33-d239fac0264d-event-1b70a52b-bf81-4d8b-9fc7-c5254d4504fa" >this gig at the Purple Turtle on Friday</a> to see and hear who made this site, because it will be fun!</p>
  </header>
  <main class="container">
    <section class="now-grid" id="now">
      <div class="card"><h2>River temperature</h2><div class="big" id="riverNow">‚Äì</div><div class="sub" id="riverUpdated">‚Äî</div></div>
      <div class="card"><h2>Air temperature</h2><div class="big" id="airNow">‚Äì</div><div class="sub">&nbsp;</div></div>
      <div class="card"><h2>Flow rate (Maidenhead)</h2><div class="big" id="flowNow">‚Äì</div><div class="sub" id="flowUpdated">‚Äî</div></div>
      <div class="card" id="sewageCard"><h2>Sewage status (Wargrave)</h2><div class="big" id="edmStatus">‚Äì</div><div class="sub" id="edmDetail">‚Äî</div></div>
<!--      <div class="card"><h2>Weather (next 24h)</h2><div class="big" id="wxNow">‚Äì</div><div class="sub" id="wxDetail">‚Äî</div></div> -->
      <div class="card">
        <h3>Forecast (Wargrave)</h3>
      
        <div id="wx-current" class="wx-current"></div>
      
        <div class="wx-daily" id="wx-daily" aria-label="7-day forecast"></div>
      
        <h4 style="margin-top:12px">Next 24 hours</h4>
        <div class="wx-hourly" id="wx-hourly" aria-label="Hourly forecast (24h)"></div>
      </div>

    </section>
    <section class="charts">
      <div class="chart-card">
  <h3 id="tempTitle">Temperatures</h3>
  <div class="range-buttons" id="tempRanges" role="group" aria-label="Temperature range">
    <button class="btn" data-days="1">24h</button>
    <button class="btn active" data-days="7">7d</button>
    <button class="btn" data-days="10">10d</button>
    <button class="btn" data-days="30">30d</button>
    <button class="btn" data-days="90">90d</button>
  </div>
  <canvas id="tempChart" height="120"></canvas>
</div>

<div class="chart-card">
  <h3 id="flowTitle">Flow rate</h3>
  <div class="range-buttons" id="flowRanges" role="group" aria-label="Flow range">
    <button class="btn" data-days="1">24h</button>
    <button class="btn active" data-days="7">7d</button>
    <button class="btn" data-days="14">14d</button>
    <button class="btn" data-days="30">30d</button>
  </div>
  <canvas id="flowChart" height="120"></canvas>
</div>

    </section>
    <section class="extras">
      <div class="map card">
        <h3>Swim stretch</h3>
        <iframe title="Wargrave Ferry Lane area map" loading="lazy" allowfullscreen referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d9945.622407729617!2d-0.868!3d51.503!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x48769b7c3a4a36d3%3A0x6f3b2a7d8c3b9e0!2sWargrave!5e0!3m2!1sen!2suk!4v1690000000000"
          width="100%" height="240" style="border:0;"></iframe>
      </div>
      <div class="card tips">
        <h3>Notes</h3>
        <ul>
          <li>This info is aggregated from other publicly available information sources; treat as indicative, not official safety advice.</li>
          <li>Temperature data from just above Shiplake Lock, via publicly available CSV files</li>
          <li>Flow data from the Environment Agency station API at Maidenhead (closest available).</li>
          <li>Sewage discharge status from Thames Water API</li>
          <li>WE ARE NOT A CLUB</li>
          <li>This is very much a work-in-progress, I'll be refining/adding things every now and then, such as weather details, discharge details etc etc</li>
          Jon
<br /> <br />
          <br />04OCT25 - Fixed issue with charts not showing enough history; registered domain name and configured DNS; expanded notes section.
          <br />05OCT25 - Signed up Met Office account and used that to retrieve daily forecast in tiles and hourly forecasts in scroller.
        </ul>
      </div>
    </section>
  </main>
  <footer class="page-footer">
    <p>Uses Environment Agency flood and river level data from the Real-time Data API (Beta). Contains public sector information licensed under the Open Government Licence v3.0.</p>
    <p>CSV temperatures courtesy of the Shiplake sensor feed. No affiliation with Thames Water or the Environment Agency.</p>
  </footer>
  <script type="module" src="app.js"></script>
</body>
</html>
